<launch>
  <include file="$(find pr2_machine)/$(env ROBOT).machine" />

  <include file="$(find pr2_moveit_config)/launch/move_group.launch" />

  <!-- Gazebo does not read these live
  <param name="/r_arm_controller/joint_trajectory_action_node/constraints/goal_time" value="10.0" />
  <param name="/l_arm_controller/joint_trajectory_action_node/constraints/goal_time" value="10.0" />
  -->
  <include file="$(find kinematics_cache)/launch/kinematics_cache.launch" />

  <!-- Mapping -->
  <include file="$(find pr2_navigation_global)/amcl_node.xml" />
  <node name="map_server" pkg="map_server" type="map_server" args="$(find humanoid_catching)/maps/map.yaml" />

  <node pkg="humanoid_catching" type="fake_human_imu" name="fake_human_imu" >
    <remap from="/out" to="/human/imu" />
  </node>
  <node pkg="humanoid_catching" type="move_arm_fast_action_server" name="right_arm_move_arm_fast_action_server" output="screen">
    <param name="arm" value="right" />
  </node>
  <node pkg="humanoid_catching" type="move_arm_fast_action_server" name="left_arm_move_arm_fast_action_server" output="screen">
    <param name="arm" value="left" />
  </node>
  <node pkg="humanoid_catching" type="catch_human_action_server" name="catch_human_action" output="screen">
  </node>

  <!-- Disabled due to spurious detections -->
  <!-- <node pkg="humanoid_catching" type="simulated_fall_detector" name="fall_detector">
    <remap from="/out" to="/human/fall" />
  </node> -->

  <node pkg="humanoid_catching" type="fall_predictor" name="fall_predictor"/>
  <node pkg="humanoid_catching" type="catching_controller" name="catching_controller" output="screen"/>

  <include file="$(find humanoid_catching)/launch/spawn_human.launch" />
</launch>
